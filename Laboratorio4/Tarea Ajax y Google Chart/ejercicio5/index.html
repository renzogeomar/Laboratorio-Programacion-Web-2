<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="css/style.css" />
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <title>"Haga gráficos comparativos entre regiones usando líneas”</title>
    </head>   
    <body>
        <h1>Gráfico comparativo de todas las regiones: </h1>
        <button onclick="mostrarGrafico()">Listar</button>
        <div id="principal">

        </div>

        <script>
            function mostrarGrafico() {
                const xhttp = new XMLHttpRequest();
                xhttp.open("GET", "../data.json", true);
                xhttp.onload = function () {
                    if (xhttp.status === 200) {
                        // Convierte la respuesta en un objeto JSON
                        const data = JSON.parse(xhttp.responseText);
        
                        // Prepara los datos para el gráfico
                        const chartData = [["Región", "Confirmados"]]; // Encabezados
                        for (let i = 0; i < data.length; i++) {
                            const region = data[i];
                            const totalConfirmados = parseInt(region.confirmed[region.confirmed.length - 1].value);
                            chartData.push([region.region, totalConfirmados]);
                        }
        
                        // Carga Google Charts y dibuja el gráfico
                        google.charts.load("current", { packages: ["corechart"] });
                        google.charts.setOnLoadCallback(function () {
                            const dataTable = google.visualization.arrayToDataTable(chartData);
        
                            const options = {
                                title: "Casos confirmados por región",
                                hAxis: { title: "Regiones", slantedText: true, slantedTextAngle: 45 }, // Muestra nombres inclinados
                                vAxis: { title: "Confirmados" },
                                legend: { position: "none" },
                                bar: { groupWidth: "95%" }, // Incrementa el tamaño de las barras
                                chartArea: { width: "85%", height: "100%" } // Ajusta el área del gráfico
                            };
        
                            const chart = new google.visualization.ColumnChart(document.getElementById("principal"));
                            chart.draw(dataTable, options);
                        });
                    } else {
                        console.error("Error al cargar el archivo data.json");
                    }
                };
        
                xhttp.onerror = function () {
                    console.error("Error de conexión al intentar cargar el archivo data.json");
                };
        
                xhttp.send();
            }
        </script>
        
    </body> 
</html>