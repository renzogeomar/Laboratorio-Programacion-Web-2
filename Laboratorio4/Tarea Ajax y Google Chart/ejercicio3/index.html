<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="css/style.css" />
        <title>"Encuentre las 10 regiones cuya suma total sea la mayor”</title>
    </head>   
    <body>
        <h1>Las 10 regiones con mayor número de contagiados: </h1>
        <button onclick="mostrar()">Listar</button>
        <div id="principal">
            <p id="lista"></p>
        </div>

        <script>
            function mostrar() {
                const xhttp = new XMLHttpRequest();
                xhttp.open("GET", "../data.json", true);
                xhttp.onload = function () {
                    if (xhttp.status === 200) {
                        // Convierte la respuesta en un objeto JSON
                        const data = JSON.parse(xhttp.responseText);
        
                        // Calcula el total de confirmados por región
                        const resultados = data.map(region => {
                            // Obtén el último valor de "confirmed"
                            const totalConfirmados = parseInt(region.confirmed[region.confirmed.length - 1].value);
        
                            // Devuelve un objeto con el nombre de la región y el total
                            return { nombre: region.region, total: totalConfirmados };
                        })
                        .sort((a, b) => b.total - a.total) // Ordena de mayor a menor
                        .slice(0, 10); // Toma las primeras 10 regiones

                        // Formatea los resultados para mostrarlos
                        const listaResultados = resultados.map(region => `${region.nombre}: ${region.total}`);

                        // Muestra los resultados en el elemento con id "lista"
                        document.getElementById("lista").innerHTML = listaResultados.join("<br>");
                    } 
                    else {
                        console.error("Error al cargar el archivo data.json");
                    }
                };
                xhttp.onerror = function () {
                    console.error("Error de conexión al intentar cargar el archivo data.json");
                };
                xhttp.send();
            }
        </script>
        
    </body> 
</html>